function HoverWatcher(t){this.hovering=!1;var a=this;this.isHoveringOver=function(){return a.hovering},$(t).hover(function(){a.hovering=!0},function(){a.hovering=!1})}function crossselling_serialScroll(){$.prototype.bxSlider&&$("#blockcart_caroucel").bxSlider({minSlides:2,maxSlides:4,slideWidth:178,slideMargin:20,moveSlides:1,infiniteLoop:!1,hideControlOnEnd:!0,pager:!1})}$(document).ready(function(){ajaxCart.overrideButtonsInThePage(),$(document).on("click",".block_cart_collapse",function(t){t.preventDefault(),ajaxCart.collapse()}),$(document).on("click",".block_cart_expand",function(t){t.preventDefault(),ajaxCart.expand()});var t=parseInt((new Date).getTime()/1e3);("undefined"==typeof $(".ajax_cart_quantity").html()||"undefined"!=typeof generated_date&&null!=generated_date&&parseInt(generated_date)+30<t)&&ajaxCart.refresh();var a=new HoverWatcher("#header .cart_block"),e=new HoverWatcher("#header .shopping_cart"),i=!1;"ontouchstart"in document.documentElement&&(i=!0),$(document).on("click","#header .shopping_cart > a:first",function(t){return t.preventDefault(),t.stopPropagation(),i?($(this).next(".cart_block:visible").length&&!a.isHoveringOver()?$("#header .cart_block").stop(!0,!0).slideUp(450):(ajaxCart.nb_total_products>0||parseInt($(".ajax_cart_quantity").html())>0)&&$("#header .cart_block").stop(!0,!0).slideDown(450),void 0):(window.location.href=$(this).attr("href"),void 0)}),$("#header .shopping_cart a:first").hover(function(){if((ajaxCart.nb_total_products>0||parseInt($(".ajax_cart_quantity").html())>0)&&$("#header .cart_block").stop(!0,!0).slideDown(450),$("#header .cart_block .products>dt").length>3){var t=3*$("#header .cart_block .products>dt").height();$("#header .cart_block .products").css({height:t,"overflow-y":"scroll"})}else $("#header .cart_block .products").css({height:"auto","overflow-y":"visible"})},function(){setTimeout(function(){e.isHoveringOver()||a.isHoveringOver()||$("#header .cart_block").stop(!0,!0).slideUp(450)},200)}),$("#header .cart_block").hover(function(){},function(){setTimeout(function(){e.isHoveringOver()||$("#header .cart_block").stop(!0,!0).slideUp(450)},200)}),$(document).on("click",".delete_voucher",function(t){t.preventDefault(),$.ajax({type:"POST",headers:{"cache-control":"no-cache"},async:!0,cache:!1,url:$(this).attr("href")+"?rand="+(new Date).getTime()}),$(this).parent().parent().remove(),ajaxCart.refresh(),("order"==$("body").attr("id")||"order-opc"==$("body").attr("id"))&&("undefined"!=typeof updateAddressSelection?updateAddressSelection():location.reload())}),$(document).on("click","#cart_navigation input",function(){$(this).prop("disabled","disabled").addClass("disabled"),$(this).closest("form").get(0).submit()}),$(document).on("click","#layer_cart .cross, #layer_cart .continue, .layer_cart_overlay",function(t){t.preventDefault(),$(".layer_cart_overlay").hide(),$("#layer_cart").fadeOut("fast")}),$("#columns #layer_cart, #columns .layer_cart_overlay").detach().prependTo("#columns")});var ajaxCart={nb_total_products:0,overrideButtonsInThePage:function(){$(document).off("click",".ajax_add_to_cart_button").on("click",".ajax_add_to_cart_button",function(t){t.preventDefault();var a=parseInt($(this).data("id-product")),e=parseInt($(this).data("id-product-attribute")),i=parseInt($(this).data("minimal_quantity"));i||(i=1),"disabled"!=$(this).prop("disabled")&&ajaxCart.add(a,e,!1,this,i)}),$(".cart_block").length&&$(document).off("click","#add_to_cart button").on("click","#add_to_cart button",function(t){t.preventDefault(),ajaxCart.add($("#product_page_product_id").val(),$("#idCombination").val(),!0,null,$("#quantity_wanted").val(),null)}),$(document).off("click",".cart_block_list .ajax_cart_block_remove_link").on("click",".cart_block_list .ajax_cart_block_remove_link",function(t){t.preventDefault();var a=0,e=0,i=0,o=$($(this).parent().parent()).find("div[data-id^=deleteCustomizableProduct_]"),r=!1;if(o&&$(o).length){var s=o.data("id").split("_");"undefined"!=typeof s[1]&&(a=parseInt(s[1]),e=parseInt(s[2]),"undefined"!=typeof s[3]&&(i=parseInt(s[3])),"undefined"!=typeof s[4]&&(r=parseInt(s[4])))}if(!a){var n=$(this).parent().parent().data("id").replace("cart_block_product_","");n=n.replace("deleteCustomizableProduct_",""),s=n.split("_"),e=parseInt(s[0]),"undefined"!=typeof s[1]&&(i=parseInt(s[1])),"undefined"!=typeof s[2]&&(r=parseInt(s[2]))}ajaxCart.remove(e,i,a,r)})},expand:function(){$(".cart_block_list").hasClass("collapsed")&&($(".cart_block_list.collapsed").slideDown({duration:450,complete:function(){$(this).parent().show(),$(this).addClass("expanded").removeClass("collapsed")}}),$.ajax({type:"POST",headers:{"cache-control":"no-cache"},url:baseDir+"modules/blockcart/blockcart-set-collapse.php?rand="+(new Date).getTime(),async:!0,cache:!1,data:"ajax_blockcart_display=expand",complete:function(){$(".block_cart_expand").fadeOut("fast",function(){$(".block_cart_collapse").fadeIn("fast")})}}))},collapse:function(){$(".cart_block_list").hasClass("expanded")&&($(".cart_block_list.expanded").slideUp("slow",function(){$(this).addClass("collapsed").removeClass("expanded")}),$.ajax({type:"POST",headers:{"cache-control":"no-cache"},url:baseDir+"modules/blockcart/blockcart-set-collapse.php?rand="+(new Date).getTime(),async:!0,cache:!1,data:"ajax_blockcart_display=collapse&rand="+(new Date).getTime(),complete:function(){$(".block_cart_collapse").fadeOut("fast",function(){$(".block_cart_expand").fadeIn("fast")})}}))},refresh:function(){$.ajax({type:"POST",headers:{"cache-control":"no-cache"},url:baseUri+"?rand="+(new Date).getTime(),async:!0,cache:!1,dataType:"json",data:"controller=cart&ajax=true&token="+static_token,success:function(t){ajaxCart.updateCart(t)}})},updateCartInformation:function(t,a){ajaxCart.updateCart(t),a?($("#add_to_cart button").removeProp("disabled").removeClass("disabled"),t.hasError&&0!=t.hasError?$("#add_to_cart button").removeClass("added"):$("#add_to_cart button").addClass("added")):$(".ajax_add_to_cart_button").removeProp("disabled")},updateFancyBox:function(){},add:function(t,a,e,i,o,r){if(e&&!checkCustomizations()){if(contentOnly){var s=window.document.location.href+"",n=s.replace("content_only=1","");return window.parent.document.location.href=n,void 0}return $.prototype.fancybox?$.fancybox.open([{type:"inline",autoScale:!0,minHeight:30,content:'<p class="fancybox-error">'+fieldRequired+"</p>"}],{padding:0}):alert(fieldRequired),void 0}e?($("#add_to_cart button").prop("disabled","disabled").addClass("disabled"),$(".filled").removeClass("filled")):$(i).prop("disabled","disabled"),$(".cart_block_list").hasClass("collapsed")&&this.expand(),$.ajax({type:"POST",headers:{"cache-control":"no-cache"},url:baseUri+"?rand="+(new Date).getTime(),async:!0,cache:!1,dataType:"json",data:"controller=cart&add=1&ajax=true&qty="+(o&&null!=o?o:"1")+"&id_product="+t+"&token="+static_token+(parseInt(a)&&null!=a?"&ipa="+parseInt(a):"&id_customization="+("undefined"!=typeof customizationId?customizationId:0)),success:function(o){r&&!o.errors&&WishlistAddProductCart(r[0],t,a,r[1]),o.hasError?(contentOnly?window.parent.ajaxCart.updateCart(o):ajaxCart.updateCart(o),e?$("#add_to_cart button").removeProp("disabled").removeClass("disabled"):$(i).removeProp("disabled")):(contentOnly?window.parent.ajaxCart.updateCartInformation(o,e):ajaxCart.updateCartInformation(o,e),o.crossSelling&&$(".crossseling").html(o.crossSelling),a?$(o.products).each(function(){void 0!=this.id&&this.id==parseInt(t)&&this.idCombination==parseInt(a)&&(contentOnly?window.parent.ajaxCart.updateLayer(this):ajaxCart.updateLayer(this))}):$(o.products).each(function(){void 0!=this.id&&this.id==parseInt(t)&&(contentOnly?window.parent.ajaxCart.updateLayer(this):ajaxCart.updateLayer(this))}),contentOnly&&parent.$.fancybox.close()),emptyCustomizations()},error:function(t,a,o){var r="Impossible to add the product to the cart.<br/>textStatus: '"+a+"'<br/>errorThrown: '"+o+"'<br/>responseText:<br/>"+t.responseText;$.prototype.fancybox?$.fancybox.open([{type:"inline",autoScale:!0,minHeight:30,content:'<p class="fancybox-error">'+r+"</p>"}],{padding:0}):alert(r),e?$("#add_to_cart button").removeProp("disabled").removeClass("disabled"):$(i).removeProp("disabled")}})},remove:function(t,a,e,i){$.ajax({type:"POST",headers:{"cache-control":"no-cache"},url:baseUri+"?rand="+(new Date).getTime(),async:!0,cache:!1,dataType:"json",data:"controller=cart&delete=1&id_product="+t+"&ipa="+(null!=a&&parseInt(a)?a:"")+(e&&null!=e?"&id_customization="+e:"")+"&id_address_delivery="+i+"&token="+static_token+"&ajax=true",success:function(o){ajaxCart.updateCart(o),("order"==$("body").attr("id")||"order-opc"==$("body").attr("id"))&&deleteProductFromSummary(t+"_"+a+"_"+e+"_"+i)},error:function(){var t="ERROR: unable to delete the product";$.prototype.fancybox?$.fancybox.open([{type:"inline",autoScale:!0,minHeight:30,content:t}],{padding:0}):alert(t)}})},hideOldProducts:function(t){if($(".cart_block_list:first dl.products").length>0){var a=null;$(".cart_block_list:first dl.products dt").each(function(){var e=$(this).data("id"),i=e.replace("cart_block_product_",""),o=i.split("_"),r=!1;for(aProduct in t.products)t.products[aProduct].id!=o[0]||o[1]&&t.products[aProduct].idCombination!=o[1]||(r=!0,ajaxCart.hideOldProductCustomizations(t.products[aProduct],e));if(!r&&(a=$(this).data("id"),null!=a)){var i=a.replace("cart_block_product_",""),o=i.split("_");$('dt[data-id="'+a+'"]').addClass("strike").fadeTo("slow",0,function(){$(this).slideUp("slow",function(){$(this).remove(),0==$(".cart_block:first dl.products dt").length&&($(".ajax_cart_quantity").html("0"),$("#header .cart_block").stop(!0,!0).slideUp(200),$(".cart_block_no_products:hidden").slideDown(450),$(".cart_block dl.products").remove())})}),$('dd[data-id="cart_block_combination_of_'+o[0]+(o[1]?"_"+o[1]:"")+(o[2]?"_"+o[2]:"")+'"]').fadeTo("fast",0,function(){$(this).slideUp("fast",function(){$(this).remove()})})}})}},hideOldProductCustomizations:function(t,a){var e=$('ul[data-id="customization_'+t.id+"_"+t.idCombination+'"]');e.length>0&&$(e).find("li").each(function(){$(this).find("div").each(function(){var a=$(this).data("id"),e=a.replace("deleteCustomizableProduct_",""),i=e.split("_");parseInt(t.idCombination)!=parseInt(i[2])||ajaxCart.doesCustomizationStillExist(t,i[0])||$('div[data-id="'+a+'"]').parent().addClass("strike").fadeTo("slow",0,function(){$(this).slideUp("slow"),$(this).remove()})})});var i=$('.deleteCustomizableProduct[data-id="'+a+'"]').find(".ajax_cart_block_remove_link");t.hasCustomizedDatas||i.length||$('div[data-id="'+a+'"] span.remove_link').html('<a class="ajax_cart_block_remove_link" rel="nofollow" href="'+baseUri+"?controller=cart&amp;delete=1&amp;id_product="+t.id+"&amp;ipa="+t.idCombination+"&amp;token="+static_token+'"> </a>'),t.is_gift&&$('div[data-id="'+a+'"] span.remove_link').html("")},doesCustomizationStillExist:function(t,a){var e=!1;return $(t.customizedDatas).each(function(){return this.customizationId==a?(e=!0,!1):void 0}),e},refreshVouchers:function(t){if("undefined"==typeof t.discounts||0==t.discounts.length)$(".vouchers").hide();else{for($(".vouchers tbody").html(""),i=0;i<t.discounts.length;i++)if(parseFloat(t.discounts[i].price_float)>0){var a="";t.discounts[i].code.length&&(a='<a class="delete_voucher" href="'+t.discounts[i].link+'" title="'+delete_txt+'"><i class="icon-remove-sign"></i></a>'),$(".vouchers tbody").append($('<tr class="bloc_cart_voucher" data-id="bloc_cart_voucher_'+t.discounts[i].id+'">	<td class="quantity">1x</td>	<td class="name" title="'+t.discounts[i].description+'">'+t.discounts[i].name+'</td>	<td class="price">-'+t.discounts[i].price+'</td>	<td class="delete">'+a+"</td></tr>"))}$(".vouchers").show()}},updateProductQuantity:function(t,a){$("dt[data-id=cart_block_product_"+t.id+"_"+(t.idCombination?t.idCombination:"0")+"_"+(t.idAddressDelivery?t.idAddressDelivery:"0")+"] .quantity").fadeTo("fast",0,function(){$(this).text(a),$(this).fadeTo("fast",1,function(){$(this).fadeTo("fast",0,function(){$(this).fadeTo("fast",1,function(){$(this).fadeTo("fast",0,function(){$(this).fadeTo("fast",1)})})})})})},displayNewProducts:function(t){$(t.products).each(function(){if(void 0!=this.id){0==$(".cart_block:first dl.products").length&&($(".cart_block_no_products").before('<dl class="products"></dl>'),$(".cart_block_no_products").hide());var t=this.id+"_"+(this.idCombination?this.idCombination:"0")+"_"+(this.idAddressDelivery?this.idAddressDelivery:"0"),a=this.id+"_"+(this.idCombination?this.idCombination:"0");if(0==$('dt[data-id="cart_block_product_'+t+'"]').length){var e=parseInt(this.id),i=(this.hasAttributes?parseInt(this.attributes):0,'<dt class="unvisible" data-id="cart_block_product_'+t+'">'),o=$.trim($("<span />").html(this.name).text());o=o.length>12?o.substring(0,10)+"...":o,i+='<a class="cart-images" href="'+this.link+'" title="'+o+'"><img  src="'+this.image_cart+'" alt="'+this.name+'"></a>',i+='<div class="cart-info"><div class="product-name"><span class="quantity-formated"><span class="quantity">'+this.quantity+'</span>&nbsp;x&nbsp;</span><a href="'+this.link+'" title="'+this.name+'" class="cart_block_product_name">'+o+"</a></div>",this.hasAttributes&&(i+='<div class="product-atributes"><a href="'+this.link+'" title="'+this.name+'">'+this.attributes+"</a></div>"),"undefined"!=typeof freeProductTranslation&&(i+='<span class="price">'+(parseFloat(this.price_float)>0?this.priceByLine:freeProductTranslation)+"</span></div>"),i+="undefined"==typeof this.is_gift||0==this.is_gift?'<span class="remove_link"><a rel="nofollow" class="ajax_cart_block_remove_link" href="'+baseUri+"?controller=cart&amp;delete=1&amp;id_product="+e+"&amp;token="+static_token+(this.hasAttributes?"&amp;ipa="+parseInt(this.idCombination):"")+'"> </a></span>':'<span class="remove_link"></span>',i+="</dt>",this.hasAttributes&&(i+='<dd data-id="cart_block_combination_of_'+t+'" class="unvisible">'),this.hasCustomizedDatas&&(i+=ajaxCart.displayNewCustomizedDatas(this)),this.hasAttributes&&(i+="</dd>"),$(".cart_block dl.products").append(i)}else{var r=this;($.trim($('dt[data-id="cart_block_product_'+t+'"] .quantity').html())!=r.quantity||$.trim($('dt[data-id="cart_block_product_'+t+'"] .price').html())!=r.priceByLine)&&(this.is_gift?$('dt[data-id="cart_block_product_'+t+'"] .price').html(freeProductTranslation):$('dt[data-id="cart_block_product_'+t+'"] .price').text(r.priceByLine),ajaxCart.updateProductQuantity(r,r.quantity),r.hasCustomizedDatas&&(customizationFormatedDatas=ajaxCart.displayNewCustomizedDatas(r),$('ul[data-id="customization_'+a+'"]').length?($('ul[data-id="customization_'+a+'"]').html(""),$('ul[data-id="customization_'+a+'"]').append(customizationFormatedDatas)):r.hasAttributes?$('dd[data-id="cart_block_combination_of_'+t+'"]').append(customizationFormatedDatas):$(".cart_block dl.products").append(customizationFormatedDatas)))}$(".cart_block dl.products .unvisible").slideDown(450).removeClass("unvisible");var s=$('dt[data-id="cart_block_product_'+t+'"]').find("a.ajax_cart_block_remove_link");this.hasCustomizedDatas&&s.length&&$(s).each(function(){$(this).remove()})}})},displayNewCustomizedDatas:function(t){var a="",e=parseInt(t.id),i="undefined"==typeof t.idCombination?0:parseInt(t.idCombination),o=$('ul[data-id="customization_'+e+"_"+i+'"]').length;return o||(t.hasAttributes||(a+='<dd data-id="cart_block_combination_of_'+e+'" class="unvisible">'),void 0==$('ul[data-id="customization_'+e+"_"+i+'"]').val()&&(a+='<ul class="cart_block_customizations" data-id="customization_'+e+"_"+i+'">')),$(t.customizedDatas).each(function(){var r=0;customizationId=parseInt(this.customizationId),i="undefined"==typeof t.idCombination?0:parseInt(t.idCombination),a+='<li name="customization"><div class="deleteCustomizableProduct" data-id="deleteCustomizableProduct_'+customizationId+"_"+e+"_"+(i?i:"0")+'"><a rel="nofollow" class="ajax_cart_block_remove_link" href="'+baseUri+"?controller=cart&amp;delete=1&amp;id_product="+e+"&amp;ipa="+i+"&amp;id_customization="+customizationId+"&amp;token="+static_token+'"></a></div>',$(this.datas).each(function(){this.type==CUSTOMIZE_TEXTFIELD&&$(this.datas).each(function(){return 0==this.index?(a+=" "+this.truncatedValue.replace(/<br \/>/g," "),r=1,!1):void 0})}),r||(a+=customizationIdMessage+customizationId),o||(a+="</li>"),customizationId&&($("#uploadable_files li div.customizationUploadBrowse img").remove(),$("#text_fields input").attr("value",""))}),o||(a+="</ul>",t.hasAttributes||(a+="</dd>")),a},updateLayer:function(t){$("#layer_cart_product_title").text(t.name),$("#layer_cart_product_attributes").text(""),t.hasAttributes&&1==t.hasAttributes&&$("#layer_cart_product_attributes").html(t.attributes),$("#layer_cart_product_price").text(t.price),$("#layer_cart_product_quantity").text(t.quantity),$(".layer_cart_img").html('<img class="layer_cart_img img-responsive" src="'+t.image+'" alt="'+t.name+'" title="'+t.name+'" />');var a=parseInt($(window).scrollTop())+"px";$(".layer_cart_overlay").css("width","100%"),$(".layer_cart_overlay").css("height","100%"),$(".layer_cart_overlay").show(),$("#layer_cart").css({top:a}).fadeIn("fast"),crossselling_serialScroll()},updateCart:function(t){if(t.hasError){var a="";for(error in t.errors)"indexOf"!=error&&(a+=$("<div />").html(t.errors[error]).text()+"\n");$.prototype.fancybox?$.fancybox.open([{type:"inline",autoScale:!0,minHeight:30,content:'<p class="fancybox-error">'+a+"</p>"}],{padding:0}):alert(a)}else ajaxCart.updateCartEverywhere(t),ajaxCart.hideOldProducts(t),ajaxCart.displayNewProducts(t),ajaxCart.refreshVouchers(t),$(".cart_block .products dt").removeClass("first_item").removeClass("last_item").removeClass("item"),$(".cart_block .products dt:first").addClass("first_item"),$(".cart_block .products dt:not(:first,:last)").addClass("item"),$(".cart_block .products dt:last").addClass("last_item")},updateCartEverywhere:function(t){$(".ajax_cart_total").text($.trim(t.productTotal)),"undefined"==typeof hasDeliveryAddress&&(hasDeliveryAddress=!1),parseFloat(t.shippingCostFloat)>0?$(".ajax_cart_shipping_cost").text(t.shippingCost).parent().find(".unvisible").show():(hasDeliveryAddress||"undefined"!=typeof orderProcess&&"order-opc"==orderProcess)&&"undefined"!=typeof freeShippingTranslation?$(".ajax_cart_shipping_cost").html(freeShippingTranslation):"undefined"==typeof toBeDetermined||hasDeliveryAddress||$(".ajax_cart_shipping_cost").html(toBeDetermined),t.shippingCostFloat||t.free_ship?hasDeliveryAddress&&!t.isVirtualCart&&$(".ajax_cart_shipping_cost").parent().find(".unvisible").show():$(".ajax_cart_shipping_cost").parent().find(".unvisible").hide(),$(".ajax_cart_tax_cost").text(t.taxCost),$(".cart_block_wrapping_cost").text(t.wrappingCost),$(".ajax_block_cart_total").text(t.total),$(".ajax_block_products_total").text(t.productTotal),$(".ajax_total_price_wt").text(t.total_price_wt),parseFloat(t.freeShippingFloat)>0?($(".ajax_cart_free_shipping").html(t.freeShipping),$(".freeshipping").fadeIn(0)):0==parseFloat(t.freeShippingFloat)&&$(".freeshipping").fadeOut(0),this.nb_total_products=t.nbTotalProducts,parseInt(t.nbTotalProducts)>0?($(".ajax_cart_no_product").hide(),$(".ajax_cart_quantity").text(t.nbTotalProducts),$(".ajax_cart_quantity").fadeIn("slow"),$(".ajax_cart_total").fadeIn("slow"),parseInt(t.nbTotalProducts)>1?($(".ajax_cart_product_txt").each(function(){$(this).hide()}),$(".ajax_cart_product_txt_s").each(function(){$(this).show()})):($(".ajax_cart_product_txt").each(function(){$(this).show()}),$(".ajax_cart_product_txt_s").each(function(){$(this).hide()}))):($(".ajax_cart_quantity, .ajax_cart_product_txt_s, .ajax_cart_product_txt, .ajax_cart_total").each(function(){$(this).hide()}),$(".ajax_cart_no_product").show("slow"))}};